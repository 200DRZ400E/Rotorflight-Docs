"use strict";(self.webpackChunkrotorflight_docs=self.webpackChunkrotorflight_docs||[]).push([[5550],{3905:(e,t,i)=>{i.d(t,{Zo:()=>c,kt:()=>u});var n=i(67294);function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}var s=n.createContext({}),h=function(e){var t=n.useContext(s),i=t;return e&&(i="function"==typeof e?e(t):a(a({},t),e)),i},c=function(e){var t=h(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var i=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=h(i),g=o,u=d["".concat(s,".").concat(g)]||d[g]||p[g]||r;return i?n.createElement(u,a(a({ref:t},c),{},{components:i})):n.createElement(u,a({ref:t},c))}));function u(e,t){var i=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=i.length,a=new Array(r);a[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:o,a[1]=l;for(var h=2;h<r;h++)a[h]=i[h];return n.createElement.apply(null,a)}return n.createElement.apply(null,i)}g.displayName="MDXCreateElement"},53613:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var n=i(87462),o=(i(67294),i(3905));const r={sidebar_position:60},a="High Speed Integral",l={unversionedId:"Tuning/High-Speed-Integral",id:"Tuning/High-Speed-Integral",title:"High Speed Integral",description:"TL;DR",source:"@site/docs/Tuning/High-Speed-Integral.md",sourceDirName:"Tuning",slug:"/Tuning/High-Speed-Integral",permalink:"/docs/Tuning/High-Speed-Integral",draft:!1,editUrl:"https://github.com/pkaig/Rotorflight-Docs/tree/main/docs/Tuning/High-Speed-Integral.md",tags:[],version:"current",sidebarPosition:60,frontMatter:{sidebar_position:60},sidebar:"tuningSidebar",previous:{title:"Tune Feedforward",permalink:"/docs/Tuning/Tune-Feedforward"},next:{title:"Motorised Tail and TTA",permalink:"/docs/Tuning/Motorised-Tail-and-TTA"}},s={},h=[{value:"What is it?",id:"what-is-it",level:2},{value:"How to tune it?",id:"how-to-tune-it",level:2},{value:"(Advanced Topic) Tick tock Optimization",id:"advanced-topic-tick-tock-optimization",level:2},{value:"(Advanced Topic) HSI Charging Rate",id:"advanced-topic-hsi-charging-rate",level:2}],c={toc:h},d="wrapper";function p(e){let{components:t,...i}=e;return(0,o.kt)(d,(0,n.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"high-speed-integral"},"High Speed Integral"),(0,o.kt)("p",null,"TL;DR\nThe high speed integral fixes bobbling problems during fast-moving maneuvers. Higher O-gain resulting in fast reaction to high airspeed. Too high might result in bobble during stops since it behaves like integral gain at constant collective position."),(0,o.kt)("h2",{id:"what-is-it"},"What is it?"),(0,o.kt)("p",null,'This is one of the core features of most advanced FBL systems (Vbar, CGY760R, Spirit .etc) The problem it is solving is maiinly due to the difference in lift from high airspeed in the x and y directions. For example, as the helicoper is moving forward while having a constant positive collective pitch, the helicopter tends to pull up. If the collective pitch is negaive, the imbalance of lift is reversed, and the heli would tend to push down. This is usually not a problem if the collective stays constant because the integral gain will compensate this constant "trim". However, when changing collective while moving at a high speed (for example, fast moving side tick tocks) the heli would not move axially. It would behave in a snake shape because the I term is constantly charging and discharging in the opposite direction.'),(0,o.kt)("p",null,'The High Speed Integral (HSI) resembles another integral term. However, its output is proportional to the collecive input, which reverses when the collective is negative. This is the "arching" effect you might see on FBLs like a vbar, where if one tilt the helicotper at high collective, and move the collective up and down, the swash plate would resemble one side of a seesaw. '),(0,o.kt)("h2",{id:"how-to-tune-it"},"How to tune it?"),(0,o.kt)("p",null,"To properly tune the HSI, one has to be able to fly maneuvers comfortably at a relatively high speed. The best maneuver is the fast moving ticktocks. It is advised to start low (about 30) and see if theres snaking at the first few tick tocks. The higher O-gain you use, the faster it reacts to high speed, meaning the amount of time ticktock becomes axial is lowered. Ideally, the O-gain should be just high enough to havo no snaking. Too high might result in bobbling during stationary tick tocks because it is essentially an I gain at constant collective."),(0,o.kt)("h2",{id:"advanced-topic-tick-tock-optimization"},"(Advanced Topic) Tick tock Optimization"),(0,o.kt)("p",null,'The problem of naively implementing the HSI is repeated maneuvers like tick tocks. The HSI works the best when the heli needs reversed "trim" when collective is reversed. However, there is another scenario that this could happen: during ticktocks. Assume there\'s some error that reverses at each stops of the ticktocks, then the HSI would tend to charge up little by little at each end, resuling unwanted bobbling right after each collective change. '),(0,o.kt)("p",null,'Currently, there seems to be three ways to solve this problem. The simplest way is to not deal with the problem at all and use a very fast I-term decay on the normal integral gain to "soothe" the effect. However, the fast I-term decay creates significant drifting problem in other scenarios, making the heli less predictable.'),(0,o.kt)("p",null,'A much more sophisicated way to deal with this issue. From behavior of the pilots, we know that when the cyclic inputs are high, theres a very low chance that the heli would keep the same airspeed at the input direction. Therefore, the HSI would be added to the normal I term (in the input direction) at some cyclic threshold. This preserves the HSI in the orthogonal direction but "deletes" them in the parallel direction.'),(0,o.kt)("p",null,'RF2 follows the previous logic. However, instead of "deleting" the HSI, it "decays" HSI in a set speed (dictated by the offset_bleed_rate_curve and offset_bleed_limit_curve parameter) into the normal-I. Therefore, a extremely fast impulse on the stick would not result in a complete deletion of the HSI.'),(0,o.kt)("h2",{id:"advanced-topic-hsi-charging-rate"},"(Advanced Topic) HSI Charging Rate"),(0,o.kt)("p",null,'Another problem with HSI is that it behaves like integral gain at constant collective with higher collective having a higher "equivalent I-gain." This problem could affect the PID balance greatly especially at high collectives. One way to solve this problem is to lower the HSI charging rate at high collective (offset_charge_curve). It effectly lowers the equivalent I-gain at high collective which helps maintain the PID balance. However, the adverse effect is that this assumes no significant airspeed change when collective is high, which in some extreme cases might not be true. Also, snaking migh occur if one prefer to use high collective during fast moving ticktocks. Therefore, it is advised to have the charge rate as high as possible at high collective to minimize the effect.'))}p.isMDXComponent=!0}}]);